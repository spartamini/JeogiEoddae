<!-- credit: mdbootstrap.com -->
<!-- link: https://mdbootstrap.com/docs/standard/extended/profiles/ -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <title>스파르타 피디아</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        font-family: "Gowun Dodum", sans-serif;
      }
      .gradient-custom-2 {
        /* fallback for old browsers */
        background: #fbc2eb;

        /* Chrome 10-25, Safari 5.1-6 */
        background: -webkit-linear-gradient(
          to right,
          rgba(251, 194, 235, 1),
          rgba(166, 193, 238, 1)
        );

        /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
        background: linear-gradient(
          to right,
          rgba(251, 194, 235, 1),
          rgba(166, 193, 238, 1)
        );
      }
    </style>
    <script>
      $(document).ready(function () {
        if (localStorage.getItem("username")) {
          load_profile();
        } else {
          alert("You need to sign in first!");
          window.location.replace("/");
          // reload to main page
        }
      });

      function load_profile() {
        let firstname = localStorage.getItem("firstname");
        let lastname = localStorage.getItem("lastname");
        let username = localStorage.getItem("username");
        let email = localStorage.getItem("email");
        let pw = localStorage.getItem("password");
        let location = localStorage.getItem("location");

        $.ajax({
          type: "POST",
          url: "/load-profile",
          data: { username_give: username, email_give: email, pw_give: pw, loc_give: location},
          success: function (response) {
            $("#user-info").empty();

            let temp_html = `<h3>${firstname} ${lastname}</h3>
            <h5>@${username}</h5>
            <p>${location}</p>`

            $("#user-info").append(temp_html);

            // list of user's posts
            post_list = response["post_list"];

            console.log(post_list);

            $("#num-photos").empty();
            $("#num-photos").append(`${post_list.length}`);

            $("#posts").empty();
            let num = post_list.length;

            for (let i = 0; i < num; i++) {
                    // TODO: specific structure of the post
              if (i % 2 == 0) {
                  let temp_html = `<div class="row g-2">
                            <div class="col">
                              <img
                                src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(108).webp"
                                alt="image 1"
                                class="w-100 rounded-3"
                              />
                              <a class="post-title" href="/post_name.html"
                                >Post Title</a
                              >
                            </div>`
                        $('#posts').append(temp_html);
                    } else {
                        let temp_html = `<div class="col">
                            <img
                              src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(114).webp"
                              alt="image 1"
                              class="w-100 rounded-3"
                            />
                            <a class="post-title" href="/post_name.html"
                              >Post Title</a
                            >
                          </div>
                        </div>`
                        $('#posts').append(temp_html);
                    }
                }
          },
        });
      }
      function edit_profile() {
        window.location.replace("edit_profile.html");
      }
    </script>
  </head>

  <body>
    <section class="h-100 gradient-custom-2">
      <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col col-lg-9 col-xl-7">
            <div class="card">
              <div
                class="rounded-top text-white d-flex flex-row"
                style="background-color: #000; height: 200px"
              >
                <div class="ms-4 mt-5 d-flex flex-column" style="width: 150px">
                  <img
                    src="../static/profile_picture.png"
                    alt="Generic placeholder image"
                    class="img-fluid img-thumbnail mt-4 mb-2"
                    style="width: 150px; z-index: 1"
                  />
                  <button
                    type="button"
                    class="btn btn-outline-dark"
                    data-mdb-ripple-color="dark"
                    style="z-index: 1"
                    onclick="edit_profile()"
                  >
                    Edit profile
                  </button>
                </div>
                <div class="ms-3" style="margin-top: 90px" id="user-info">
                  <h5>Andy Horwitz</h5>
                  <p>New York</p>
                </div>
              </div>
              <div class="p-4 text-black" style="background-color: #f8f9fa">
                <div class="d-flex justify-content-end text-center py-1">
                  <div>
                    <p class="mb-1 h5" id="num-photos"></p>
                    <p class="small text-muted mb-0">Posts</p>
                  </div>
                </div>
              </div>
              <div class="card-body p-4 text-black">
                
                <div
                  class="d-flex justify-content-between align-items-center mb-4"
                >
                  <p class="lead fw-normal mb-0">Recent photos</p>
                  <p class="mb-0">
                    <a href="/" class="text-muted">Home</a>
                    <a href="" class="text-muted">Show all</a>
                  </p>
                </div>
                <div>
                <div class="row g-2">
                  <div class="col mb-2">
                    <img
                      src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(112).webp"
                      alt="image 1"
                      class="w-100 rounded-3"
                      href="/post_name.html"
                    />
                    <a class="post-title" href="/post_name.html">Post Title</a>
                  </div>
                  <div class="col mb-2">
                    <img
                      src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(107).webp"
                      alt="image 1"
                      class="w-100 rounded-3"
                    />
                    <a class="post-title" href="/post_name.html">Post Title</a>
                  </div>
                </div>
            <div id="posts">
                <div class="row g-2">
                  <div class="col">
                    <img
                      src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(108).webp"
                      alt="image 1"
                      class="w-100 rounded-3"
                    />
                    <a class="post-title" href="/post_name.html">Post Title</a>
                  </div>
                  <div class="col">
                    <img
                      src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(114).webp"
                      alt="image 1"
                      class="w-100 rounded-3"
                    />
                    <a class="post-title" href="/post_name.html">Post Title</a>
                  </div>
                </div>
            </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </body>
</html>
